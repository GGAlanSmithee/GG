!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.GG100k=t()}}(function(){var t;return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=t("mainloop.js");a="default"in a?a["default"]:a;var o=t("gg-entities"),u=function(){function t(){r(this,t),this.entityManager=new o.EntityManager(200)}return i(t,[{key:"update",value:function(t){this.entityManager.onLogic(t)}},{key:"draw",value:function(t){this.entityManager.onRender(t)}}]),t}(),s=function(){function t(){r(this,t),this.game=new u}return i(t,[{key:"update",value:function(t){console.log("...updating"),this.game.update(t)}},{key:"draw",value:function(t){console.log("...drawing"),this.game.draw(t)}},{key:"run",value:function(){var t=this;a.setUpdate(function(e){t.update(e)}).setDraw(function(e){t.draw(e)}).start()}}]),t}();n.App=s},{"gg-entities":2,"mainloop.js":3}],2:[function(e,n,r){(function(i){!function(e){if("object"==typeof r&&"undefined"!=typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t([],e);else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this,a.GGEntities=e()}}(function(){return function t(n,r,i){function a(u,s){if(!r[u]){if(!n[u]){var c="function"==typeof e&&e;if(!s&&c)return c(u,!0);if(o)return o(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[u]={exports:{}};n[u][0].call(l.exports,function(t){var e=n[u][1][t];return a(e?e:t)},l,l.exports,t,n,r,i)}return r[u].exports}for(var o="function"==typeof e&&e,u=0;u<i.length;u++)a(i[u]);return a}({1:[function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=Array.prototype.slice,o=function(){function t(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(s){i=!0,a=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(){function t(){i(this,t),this.components=new Map}return u(t,[{key:"newComponent",value:function(t){var e=this.components.get(t);if(null===e||void 0===e)return null;switch(typeof e){case"function":return new e;case"object":return function(t){var e={};return Object.keys(t).forEach(function(n){return e[n]=t[n]}),e}(e)}return e}},{key:"registerComponent",value:function(t){if(null===t||void 0===t)throw TypeError("component cannot be null.");var e=Math.max.apply(Math,r(this.components.keys())),n=void 0===e||null===e||e===-(1/0)?1:0===e?1:2*e;return this.components.set(n,t),n}},{key:"getComponents",value:function(){return this.components}}]),t}();n.ComponentManager=s;var c={Logic:0,Render:1},f=function(){function t(){i(this,t),this.logicSystems=new Map,this.renderSystems=new Map}return u(t,[{key:"registerSystem",value:function(t,e,n,i){if(t!==c.Logic&&t!==c.Render)throw TypeError("type must be a valid SystemType.");if(e!==y.Get&&e!==y.GetWith&&e!==y.GetWithOnly&&e!==y.GetWithout)throw TypeError("selector must be a valid SelectorType.");if("number"!=typeof n)throw TypeError("components must be a number.");if("function"!=typeof i)throw TypeError("callback must be a function.");var a={selector:e,components:n,callback:i},o=Math.max.apply(Math,[0].concat(r(this.logicSystems.keys()),r(this.renderSystems.keys())))+1;switch(t){case c.Logic:this.logicSystems.set(o,a);break;case c.Render:this.renderSystems.set(o,a)}return o}},{key:"removeSystem",value:function(t){return this.logicSystems["delete"](t)||this.renderSystems["delete"](t)}}]),t}();n.SystemManager=f,n.SystemType=c;var l=function(){function t(){i(this,t),this.events=new Map}return u(t,[{key:"emptyPromise",value:function(){return new Promise(function(t){t()})}},{key:"promise",value:function(t,e,n,i){return new Promise(i?function(a){setTimeout(function(){a("object"==typeof e?t.call.apply(t,[e].concat(r(n))):t.apply.apply(t,[e].concat(r(n))))},i)}:function(i){i("object"==typeof e?t.call.apply(t,[e].concat(r(n))):t.apply.apply(t,[e].concat(r(n))))})}},{key:"listen",value:function(t,e){if("string"==typeof t&&"function"==typeof e){this.events.has(t)||this.events.set(t,new Map);var n=-1;return this.events.forEach(function(t){n=Math.max.apply(Math,[n].concat(r(t.keys())))}),++n,this.events.get(t).set(n,e),n}}},{key:"stopListen",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=this.events.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,u=!0,s=!1,c=void 0;try{for(var f,l=o.keys()[Symbol.iterator]();!(u=(f=l.next()).done);u=!0){var y=f.value;if(y===t)return o["delete"](t)}}catch(h){s=!0,c=h}finally{try{!u&&l["return"]&&l["return"]()}finally{if(s)throw c}}}}catch(h){n=!0,r=h}finally{try{!e&&a["return"]&&a["return"]()}finally{if(n)throw r}}return!1}},{key:"trigger",value:function(){var t=this instanceof h?this.eventHandler:this,e=Array.from(arguments),n=e.splice(0,1),r=o(n,1),i=r[0];if("string"!=typeof i||!t.events.has(i))return t.emptyPromise();var a=[],u=!0,s=!1,c=void 0;try{for(var f,l=t.events.get(i).values()[Symbol.iterator]();!(u=(f=l.next()).done);u=!0){var y=f.value;a.push(t.promise(y,this,e,1))}}catch(v){s=!0,c=v}finally{try{!u&&l["return"]&&l["return"]()}finally{if(s)throw c}}return Promise.all(a)}},{key:"triggerDelayed",value:function(){var t=this instanceof h?this.eventHandler:this,e=Array.from(arguments),n=e.splice(0,2),r=o(n,2),i=r[0],a=r[1];if("string"!=typeof i||!Number.isInteger(a)||!t.events.has(i))return t.emptyPromise();var u=[],s=!0,c=!1,f=void 0;try{for(var l,y=t.events.get(i).values()[Symbol.iterator]();!(s=(l=y.next()).done);s=!0){var v=l.value;u.push(t.promise(v,this,e,a))}}catch(p){c=!0,f=p}finally{try{!s&&y["return"]&&y["return"]()}finally{if(c)throw f}}return Promise.all(u)}}]),t}();n.EventHandler=l;var y={Get:0,GetWith:1,GetWithOnly:2,GetWithout:3},h=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];i(this,t),this.capacity=e,this.currentMaxEntity=-1,this.entityFactory=new v,this.systemManager=new f,this.componentManager=new s,this.eventHandler=new l,this.entities=Array.from({length:this.capacity},function(t){return t=0})}return u(t,[{key:"increaseCapacity",value:function(){var t=this.capacity;this.capacity*=2;for(var e=t;e<this.capacity;++e)this.entities[e]=0;var n=!0,r=!1,i=void 0;try{for(var a,o=this.componentManager.getComponents().keys()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)for(var u=a.value,e=t;e<this.capacity;++e)this[u].push(this.componentManager.newComponent(u))}catch(s){r=!0,i=s}finally{try{!n&&o["return"]&&o["return"]()}finally{if(r)throw i}}}},{key:"newEntity",value:function(t){if("number"!=typeof t||0>=t)return this.capacity;for(var e=0;e<this.capacity&&0!==this.entities[e];++e);return e>=this.capacity?this.capacity:(e>this.currentMaxEntity&&(this.currentMaxEntity=e),this.entities[e]=t,e)}},{key:"deleteEntity",value:function(t){if(this.entities[t]=0,!(t<this.currentMaxEntity))for(var e=t;e>=0;--e)if(0!==this.entities[e])return void(this.currentMaxEntity=e)}},{key:"getEntities",value:regeneratorRuntime.mark(function e(){var t,n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],r=arguments.length<=1||void 0===arguments[1]?y.GetWith:arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next=e.t0===y.GetWith?3:e.t0===y.GetWithOnly?14:e.t0===y.GetWithout?25:e.t0===y.Get?36:46;break;case 3:e.t1=regeneratorRuntime.keys(this.entities);case 4:if((e.t2=e.t1()).done){e.next=13;break}if(t=e.t2.value,!(t>this.currentMaxEntity)){e.next=8;break}return e.abrupt("return");case 8:if(0===this.entities[t]||(this.entities[t]&n)!==n){e.next=11;break}return e.next=11,Math.floor(t);case 11:e.next=4;break;case 13:return e.abrupt("break",46);case 14:e.t3=regeneratorRuntime.keys(this.entities);case 15:if((e.t4=e.t3()).done){e.next=24;break}if(t=e.t4.value,!(t>this.currentMaxEntity)){e.next=19;break}return e.abrupt("return");case 19:if(0===this.entities[t]||this.entities[t]!==n){e.next=22;break}return e.next=22,Math.floor(t);case 22:e.next=15;break;case 24:return e.abrupt("break",46);case 25:e.t5=regeneratorRuntime.keys(this.entities);case 26:if((e.t6=e.t5()).done){e.next=35;break}if(t=e.t6.value,!(t>this.currentMaxEntity)){e.next=30;break}return e.abrupt("return");case 30:if(0===this.entities[t]||(this.entities[t]&n)===n){e.next=33;break}return e.next=33,Math.floor(t);case 33:e.next=26;break;case 35:return e.abrupt("break",46);case 36:e.t7=regeneratorRuntime.keys(this.entities);case 37:if((e.t8=e.t7()).done){e.next=45;break}if(t=e.t8.value,!(t>this.currentMaxEntity)){e.next=41;break}return e.abrupt("return");case 41:return e.next=43,Math.floor(t);case 43:e.next=37;break;case 45:return e.abrupt("break",46);case 46:case"end":return e.stop()}},e,this)})},{key:"registerComponent",value:function(t){var e=this.componentManager.registerComponent(t);this[e]=[];for(var n=0;n<this.capacity;++n)this[e].push(this.componentManager.newComponent(e));var r=void 0;switch(typeof t){case"function":r=t;break;case"object":r=function(){var e=!0,n=!1,r=void 0;try{for(var i,a=Object.keys(t)[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;this[o]=t[o]}}catch(u){n=!0,r=u}finally{try{!e&&a["return"]&&a["return"]()}finally{if(n)throw r}}};break;default:r=function(){return t}}return this.entityFactory.registerInitializer(e,r),e}},{key:"addComponent",value:function(t,e){this.entities[t]|=e}},{key:"removeComponent",value:function(t,e){this.entities[t]&=~e}},{key:"registerSystem",value:function(t,e,n,r){return this.systemManager.registerSystem(t,e,n,r)}},{key:"registerLogicSystem",value:function(t,e,n){return this.systemManager.registerSystem(c.Logic,t,e,n)}},{key:"registerRenderSystem",value:function(t,e,n){return this.systemManager.registerSystem(c.Render,t,e,n)}},{key:"removeSystem",value:function(t){return this.systemManager.removeSystem(t)}},{key:"onLogic",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=this.systemManager.logicSystems.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.callback.call(this,this.getEntities(o.components,o.selector),t)}}catch(u){n=!0,r=u}finally{try{!e&&a["return"]&&a["return"]()}finally{if(n)throw r}}}},{key:"onRender",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=this.systemManager.renderSystems.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.callback.call(this,this.getEntities(o.components,o.selector),t)}}catch(u){n=!0,r=u}finally{try{!e&&a["return"]&&a["return"]()}finally{if(n)throw r}}}},{key:"registerInitializer",value:function(t,e){this.entityFactory.registerInitializer(t,e)}},{key:"build",value:function(){return this.entityFactory.build(),this}},{key:"withComponent",value:function(t,e){return this.entityFactory.withComponent(t,e),this}},{key:"createConfiguration",value:function(){return this.entityFactory.createConfiguration()}},{key:"create",value:function(t,e){return this.entityFactory.create(this,t,e)}},{key:"listen",value:function(t,e){return this.eventHandler.listen(t,e)}},{key:"stopListen",value:function(t){return this.eventHandler.stopListen(t)}},{key:"trigger",value:function(){var t;return(t=this.eventHandler.trigger).call.apply(t,[this].concat(a.call(arguments)))}},{key:"triggerDelayed",value:function(){var t;return(t=this.eventHandler.triggerDelayed).call.apply(t,[this].concat(a.call(arguments)))}}]),t}(),v=function(){function t(){i(this,t),this.initializers=new Map,this.configuration=new Map}return u(t,[{key:"registerInitializer",value:function(t,e){Number.isInteger(t)&&"function"==typeof e&&this.initializers.set(t,e)}},{key:"build",value:function(){return this.configuration=new Map,this}},{key:"withComponent",value:function(t,e){return Number.isInteger(t)?("function"!=typeof e&&(e=this.initializers.get(t)),this.configuration.set(t,e),this):this}},{key:"createConfiguration",value:function(){return this.configuration}},{key:"create",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];if(!(t instanceof h))return[];n=n||this.configuration;var r=0,i=!0,a=!1,u=void 0;try{for(var s,c=n.keys()[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;r|=f}}catch(l){a=!0,u=l}finally{try{!i&&c["return"]&&c["return"]()}finally{if(a)throw u}}for(var y=[],v=0;e>v;++v){var p=t.newEntity(r);if(!(p>=t.capacity)){var m=!0,g=!1,d=void 0;try{for(var b,k=n[Symbol.iterator]();!(m=(b=k.next()).done);m=!0){var w=o(b.value,2),x=w[0],M=w[1];if("function"==typeof M){var S=M.call(t[x][p]);"function"!=typeof t[x][p]&&"object"!=typeof t[x][p]&&void 0!==S&&(t[x][p]=S)}}}catch(l){g=!0,d=l}finally{try{!m&&k["return"]&&k["return"]()}finally{if(g)throw d}}y.push(p)}}return 1===y.length?y[0]:y}}]),t}();n.EntityManager=h,n.SelectorType=y},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,n,r){!function(e){function i(t){if(s+h>t)return void(a=g(i));for(u+=t-s,s=t,k(t,u),t>f+1e3&&(c=.25*l+.75*c,f=t,l=0),l++,y=0;u>=o;)if(w(o),u-=o,++y>=240){m=!0;break}x(u/o),M(c,m),m=!1,a=g(i)}var a,o=1e3/60,u=0,s=0,c=60,f=0,l=0,y=0,h=0,v=!1,p=!1,m=!1,g=e.requestAnimationFrame||function(){var t,e,n=Date.now();return function(r){return t=Date.now(),e=Math.max(0,o-(t-n)),n=t+e,setTimeout(function(){r(t+e)},e)}}(),d=e.cancelAnimationFrame||clearTimeout,b=function(){},k=b,w=b,x=b,M=b;e.MainLoop={getSimulationTimestep:function(){return o},setSimulationTimestep:function(t){return o=t,this},getFPS:function(){return c},getMaxAllowedFPS:function(){return 1e3/h},setMaxAllowedFPS:function(t){return"undefined"==typeof t&&(t=1/0),0===t?this.stop():h=1e3/t,this},resetFrameDelta:function(){var t=u;return u=0,t},setBegin:function(t){return k=t||k,this},setUpdate:function(t){return w=t||w,this},setDraw:function(t){return x=t||x,this},setEnd:function(t){return M=t||M,this},start:function(){return p||(p=!0,g(function(t){x(1),v=!0,s=t,f=t,l=0,a=g(i)})),this},stop:function(){return v=!1,p=!1,d(a),this},isRunning:function(){return v}},"function"==typeof t&&t.amd?t(e.MainLoop):"object"==typeof r&&(n.exports=e.MainLoop)}(this)},{}]},{},[1])(1)});