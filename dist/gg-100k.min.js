!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.GG100k=e()}}(function(){var e;return function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var n=e[a][1][t];return i(n?n:t)},f,f.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;u=c=s=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;e=c,t=o,n=a,r=!0}},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("gg-entities");u="default"in u?u["default"]:u;var s=e("mainloop.js");s="default"in s?s["default"]:s;var c=function(){function e(t){i(this,e),this.renderer=t,this.entityManager=new u.EntityManager(200)}return a(e,[{key:"update",value:function(e){this.renderer.update(e)}},{key:"draw",value:function(e){this.renderer.draw(e)}}]),e}();n.Game=c;var f=function(e,t,n){var r=!1,i=!0,o=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;if(t instanceof c){r=!0;break}}}catch(f){o=!0,a=f}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw a}}if(!r){var l=[],y=!0,h=!1,v=void 0;try{for(var p,d=n[Symbol.iterator]();!(y=(p=d.next()).done);y=!0){var c=p.value;l.push(c.name)}}catch(f){h=!0,v=f}finally{try{!y&&d["return"]&&d["return"]()}finally{if(h)throw v}}throw l=l.join(" or "),TypeError(["Cannot instantiate interface",e.name,"use",l,"instead"].join(" "))}},l=function(e,t){var n=[];if(Object.getOwnPropertyNames(e.prototype).forEach(function(e){Object.getPrototypeOf(t).hasOwnProperty(e)||n.push(e)}),n.length>0)throw new TypeError([t.constructor.name,"does not implement",e.name,"methods"].concat(n).join(" "))},y=function(){function e(){i(this,e),f(e,this,[h,v]),l(e,this)}return a(e,[{key:"update",value:function(){}},{key:"draw",value:function(){}}]),e}();n.IRenderer=y;var h=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return r(t,e),a(t,[{key:"update",value:function(e){console.log("debug update",e)}},{key:"draw",value:function(e){console.log("debug draw",e)}}]),t}(y);n.DebugRenderer=h;var v=function(e){function t(){if(i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),"undefined"==typeof window)throw Error("ThreeRenderer can only be used in a browser environment.");var e=window.THREE;if(!e)throw Error("ThreeRenderer requires three.js, include it first.");this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new e.WebGLRenderer,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement);var n=new e.BoxGeometry(1,1,1),r=new e.MeshBasicMaterial({color:65280});this.cube=new e.Mesh(n,r),this.scene.add(this.cube),this.camera.position.z=5}return r(t,e),a(t,[{key:"update",value:function(e){this.entityManager.onLogic(e),this.cube.rotation.x+=.1,this.cube.rotation.y+=.1}},{key:"draw",value:function(e){this.entityManager.onRender(e),this.renderer.render(this.scene,this.camera)}}]),t}(y);n.ThreeRenderer=v;var p=function(){function e(t){i(this,e),this.game=t}return a(e,[{key:"update",value:function(e){this.game.update(e)}},{key:"draw",value:function(e){this.game.draw(e)}},{key:"run",value:function(){var e=this;s.setUpdate(function(t){e.update(t)}).setDraw(function(t){e.draw(t)}).start()}}]),e}();n.App=p},{"gg-entities":2,"mainloop.js":3}],2:[function(t,n,r){(function(i){!function(t){if("object"==typeof r&&"undefined"!=typeof n)n.exports=t();else if("function"==typeof e&&e.amd)e([],t);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this,o.GGEntities=t()}}(function(){return function e(n,r,i){function o(u,s){if(!r[u]){if(!n[u]){var c="function"==typeof t&&t;if(!s&&c)return c(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[u]={exports:{}};n[u][0].call(l.exports,function(e){var t=n[u][1][e];return o(t?t:e)},l,l.exports,e,n,r,i)}return r[u].exports}for(var a="function"==typeof t&&t,u=0;u<i.length;u++)o(i[u]);return o}({1:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=Array.prototype.slice,a=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(){i(this,e),this.components=new Map}return u(e,[{key:"newComponent",value:function(e){var t=this.components.get(e);if(null===t||void 0===t)return null;switch(typeof t){case"function":return new t;case"object":return function(e){var t={};return Object.keys(e).forEach(function(n){return t[n]=e[n]}),t}(t)}return t}},{key:"registerComponent",value:function(e){if(null===e||void 0===e)throw TypeError("component cannot be null.");var t=Math.max.apply(Math,r(this.components.keys())),n=void 0===t||null===t||t===-(1/0)?1:0===t?1:2*t;return this.components.set(n,e),n}},{key:"getComponents",value:function(){return this.components}}]),e}();n.ComponentManager=s;var c={Logic:0,Render:1},f=function(){function e(){i(this,e),this.logicSystems=new Map,this.renderSystems=new Map}return u(e,[{key:"registerSystem",value:function(e,t,n,i){if(e!==c.Logic&&e!==c.Render)throw TypeError("type must be a valid SystemType.");if(t!==y.Get&&t!==y.GetWith&&t!==y.GetWithOnly&&t!==y.GetWithout)throw TypeError("selector must be a valid SelectorType.");if("number"!=typeof n)throw TypeError("components must be a number.");if("function"!=typeof i)throw TypeError("callback must be a function.");var o={selector:t,components:n,callback:i},a=Math.max.apply(Math,[0].concat(r(this.logicSystems.keys()),r(this.renderSystems.keys())))+1;switch(e){case c.Logic:this.logicSystems.set(a,o);break;case c.Render:this.renderSystems.set(a,o)}return a}},{key:"removeSystem",value:function(e){return this.logicSystems["delete"](e)||this.renderSystems["delete"](e)}}]),e}();n.SystemManager=f,n.SystemType=c;var l=function(){function e(){i(this,e),this.events=new Map}return u(e,[{key:"emptyPromise",value:function(){return new Promise(function(e){e()})}},{key:"promise",value:function(e,t,n,i){return new Promise(i?function(o){setTimeout(function(){o("object"==typeof t?e.call.apply(e,[t].concat(r(n))):e.apply.apply(e,[t].concat(r(n))))},i)}:function(i){i("object"==typeof t?e.call.apply(e,[t].concat(r(n))):e.apply.apply(e,[t].concat(r(n))))})}},{key:"listen",value:function(e,t){if("string"==typeof e&&"function"==typeof t){this.events.has(e)||this.events.set(e,new Map);var n=-1;return this.events.forEach(function(e){n=Math.max.apply(Math,[n].concat(r(e.keys())))}),++n,this.events.get(e).set(n,t),n}}},{key:"stopListen",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.events.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,u=!0,s=!1,c=void 0;try{for(var f,l=a.keys()[Symbol.iterator]();!(u=(f=l.next()).done);u=!0){var y=f.value;if(y===e)return a["delete"](e)}}catch(h){s=!0,c=h}finally{try{!u&&l["return"]&&l["return"]()}finally{if(s)throw c}}}}catch(h){n=!0,r=h}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}return!1}},{key:"trigger",value:function(){var e=this instanceof h?this.eventHandler:this,t=Array.from(arguments),n=t.splice(0,1),r=a(n,1),i=r[0];if("string"!=typeof i||!e.events.has(i))return e.emptyPromise();var o=[],u=!0,s=!1,c=void 0;try{for(var f,l=e.events.get(i).values()[Symbol.iterator]();!(u=(f=l.next()).done);u=!0){var y=f.value;o.push(e.promise(y,this,t,1))}}catch(v){s=!0,c=v}finally{try{!u&&l["return"]&&l["return"]()}finally{if(s)throw c}}return Promise.all(o)}},{key:"triggerDelayed",value:function(){var e=this instanceof h?this.eventHandler:this,t=Array.from(arguments),n=t.splice(0,2),r=a(n,2),i=r[0],o=r[1];if("string"!=typeof i||!Number.isInteger(o)||!e.events.has(i))return e.emptyPromise();var u=[],s=!0,c=!1,f=void 0;try{for(var l,y=e.events.get(i).values()[Symbol.iterator]();!(s=(l=y.next()).done);s=!0){var v=l.value;u.push(e.promise(v,this,t,o))}}catch(p){c=!0,f=p}finally{try{!s&&y["return"]&&y["return"]()}finally{if(c)throw f}}return Promise.all(u)}}]),e}();n.EventHandler=l;var y={Get:0,GetWith:1,GetWithOnly:2,GetWithout:3},h=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];i(this,e),this.capacity=t,this.currentMaxEntity=-1,this.entityFactory=new v,this.systemManager=new f,this.componentManager=new s,this.eventHandler=new l,this.entities=Array.from({length:this.capacity},function(e){return e=0})}return u(e,[{key:"increaseCapacity",value:function(){var e=this.capacity;this.capacity*=2;for(var t=e;t<this.capacity;++t)this.entities[t]=0;var n=!0,r=!1,i=void 0;try{for(var o,a=this.componentManager.getComponents().keys()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)for(var u=o.value,t=e;t<this.capacity;++t)this[u].push(this.componentManager.newComponent(u))}catch(s){r=!0,i=s}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}},{key:"newEntity",value:function(e){if("number"!=typeof e||0>=e)return this.capacity;for(var t=0;t<this.capacity&&0!==this.entities[t];++t);return t>=this.capacity?this.capacity:(t>this.currentMaxEntity&&(this.currentMaxEntity=t),this.entities[t]=e,t)}},{key:"deleteEntity",value:function(e){if(this.entities[e]=0,!(e<this.currentMaxEntity))for(var t=e;t>=0;--t)if(0!==this.entities[t])return void(this.currentMaxEntity=t)}},{key:"getEntities",value:regeneratorRuntime.mark(function t(){var e,n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],r=arguments.length<=1||void 0===arguments[1]?y.GetWith:arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next=t.t0===y.GetWith?3:t.t0===y.GetWithOnly?14:t.t0===y.GetWithout?25:t.t0===y.Get?36:46;break;case 3:t.t1=regeneratorRuntime.keys(this.entities);case 4:if((t.t2=t.t1()).done){t.next=13;break}if(e=t.t2.value,!(e>this.currentMaxEntity)){t.next=8;break}return t.abrupt("return");case 8:if(0===this.entities[e]||(this.entities[e]&n)!==n){t.next=11;break}return t.next=11,Math.floor(e);case 11:t.next=4;break;case 13:return t.abrupt("break",46);case 14:t.t3=regeneratorRuntime.keys(this.entities);case 15:if((t.t4=t.t3()).done){t.next=24;break}if(e=t.t4.value,!(e>this.currentMaxEntity)){t.next=19;break}return t.abrupt("return");case 19:if(0===this.entities[e]||this.entities[e]!==n){t.next=22;break}return t.next=22,Math.floor(e);case 22:t.next=15;break;case 24:return t.abrupt("break",46);case 25:t.t5=regeneratorRuntime.keys(this.entities);case 26:if((t.t6=t.t5()).done){t.next=35;break}if(e=t.t6.value,!(e>this.currentMaxEntity)){t.next=30;break}return t.abrupt("return");case 30:if(0===this.entities[e]||(this.entities[e]&n)===n){t.next=33;break}return t.next=33,Math.floor(e);case 33:t.next=26;break;case 35:return t.abrupt("break",46);case 36:t.t7=regeneratorRuntime.keys(this.entities);case 37:if((t.t8=t.t7()).done){t.next=45;break}if(e=t.t8.value,!(e>this.currentMaxEntity)){t.next=41;break}return t.abrupt("return");case 41:return t.next=43,Math.floor(e);case 43:t.next=37;break;case 45:return t.abrupt("break",46);case 46:case"end":return t.stop()}},t,this)})},{key:"registerComponent",value:function(e){var t=this.componentManager.registerComponent(e);this[t]=[];for(var n=0;n<this.capacity;++n)this[t].push(this.componentManager.newComponent(t));var r=void 0;switch(typeof e){case"function":r=e;break;case"object":r=function(){var t=!0,n=!1,r=void 0;try{for(var i,o=Object.keys(e)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this[a]=e[a]}}catch(u){n=!0,r=u}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}};break;default:r=function(){return e}}return this.entityFactory.registerInitializer(t,r),t}},{key:"addComponent",value:function(e,t){this.entities[e]|=t}},{key:"removeComponent",value:function(e,t){this.entities[e]&=~t}},{key:"registerSystem",value:function(e,t,n,r){return this.systemManager.registerSystem(e,t,n,r)}},{key:"registerLogicSystem",value:function(e,t,n){return this.systemManager.registerSystem(c.Logic,e,t,n)}},{key:"registerRenderSystem",value:function(e,t,n){return this.systemManager.registerSystem(c.Render,e,t,n)}},{key:"removeSystem",value:function(e){return this.systemManager.removeSystem(e)}},{key:"onLogic",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.systemManager.logicSystems.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.callback.call(this,this.getEntities(a.components,a.selector),e)}}catch(u){n=!0,r=u}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},{key:"onRender",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.systemManager.renderSystems.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.callback.call(this,this.getEntities(a.components,a.selector),e)}}catch(u){n=!0,r=u}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},{key:"registerInitializer",value:function(e,t){this.entityFactory.registerInitializer(e,t)}},{key:"build",value:function(){return this.entityFactory.build(),this}},{key:"withComponent",value:function(e,t){return this.entityFactory.withComponent(e,t),this}},{key:"createConfiguration",value:function(){return this.entityFactory.createConfiguration()}},{key:"create",value:function(e,t){return this.entityFactory.create(this,e,t)}},{key:"listen",value:function(e,t){return this.eventHandler.listen(e,t)}},{key:"stopListen",value:function(e){return this.eventHandler.stopListen(e)}},{key:"trigger",value:function(){var e;return(e=this.eventHandler.trigger).call.apply(e,[this].concat(o.call(arguments)))}},{key:"triggerDelayed",value:function(){var e;return(e=this.eventHandler.triggerDelayed).call.apply(e,[this].concat(o.call(arguments)))}}]),e}(),v=function(){function e(){i(this,e),this.initializers=new Map,this.configuration=new Map}return u(e,[{key:"registerInitializer",value:function(e,t){Number.isInteger(e)&&"function"==typeof t&&this.initializers.set(e,t)}},{key:"build",value:function(){return this.configuration=new Map,this}},{key:"withComponent",value:function(e,t){return Number.isInteger(e)?("function"!=typeof t&&(t=this.initializers.get(e)),this.configuration.set(e,t),this):this}},{key:"createConfiguration",value:function(){return this.configuration}},{key:"create",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];if(!(e instanceof h))return[];n=n||this.configuration;var r=0,i=!0,o=!1,u=void 0;try{for(var s,c=n.keys()[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;r|=f}}catch(l){o=!0,u=l}finally{try{!i&&c["return"]&&c["return"]()}finally{if(o)throw u}}for(var y=[],v=0;t>v;++v){var p=e.newEntity(r);if(!(p>=e.capacity)){var d=!0,m=!1,g=void 0;try{for(var w,b=n[Symbol.iterator]();!(d=(w=b.next()).done);d=!0){var k=a(w.value,2),x=k[0],M=k[1];if("function"==typeof M){var S=M.call(e[x][p]);"function"!=typeof e[x][p]&&"object"!=typeof e[x][p]&&void 0!==S&&(e[x][p]=S)}}}catch(l){m=!0,g=l}finally{try{!d&&b["return"]&&b["return"]()}finally{if(m)throw g}}y.push(p)}}return 1===y.length?y[0]:y}}]),e}();n.EntityManager=h,n.SelectorType=y},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,n,r){!function(t){function i(e){if(s+h>e)return void(o=m(i));for(u+=e-s,s=e,b(e,u),e>f+1e3&&(c=.25*l+.75*c,f=e,l=0),l++,y=0;u>=a;)if(k(a),u-=a,++y>=240){d=!0;break}x(u/a),M(c,d),d=!1,o=m(i)}var o,a=1e3/60,u=0,s=0,c=60,f=0,l=0,y=0,h=0,v=!1,p=!1,d=!1,m=t.requestAnimationFrame||function(){var e,t,n=Date.now();return function(r){return e=Date.now(),t=Math.max(0,a-(e-n)),n=e+t,setTimeout(function(){r(e+t)},t)}}(),g=t.cancelAnimationFrame||clearTimeout,w=function(){},b=w,k=w,x=w,M=w;t.MainLoop={getSimulationTimestep:function(){return a},setSimulationTimestep:function(e){return a=e,this},getFPS:function(){return c},getMaxAllowedFPS:function(){return 1e3/h},setMaxAllowedFPS:function(e){return"undefined"==typeof e&&(e=1/0),0===e?this.stop():h=1e3/e,this},resetFrameDelta:function(){var e=u;return u=0,e},setBegin:function(e){return b=e||b,this},setUpdate:function(e){return k=e||k,this},setDraw:function(e){return x=e||x,this},setEnd:function(e){return M=e||M,this},start:function(){return p||(p=!0,m(function(e){x(1),v=!0,s=e,f=e,l=0,o=m(i)})),this},stop:function(){return v=!1,p=!1,g(o),this},isRunning:function(){return v}},"function"==typeof e&&e.amd?e(t.MainLoop):"object"==typeof r&&(n.exports=t.MainLoop)}(this)},{}]},{},[1])(1)});